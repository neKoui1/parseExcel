# parseExcel

根据wechat 聊天记录解析生成json 文件方便LLM 处理

## 1. 功能

- 批量处理微信导出的Excel 聊天记录文件
- 按照用户对每一位客户的对话，将聊天记录按时间顺序整理成JSON格式输出
- 支持多个Excel 文件中的去重操作，避免同一条聊天记录重复导入

## 2. 输入文件

Excel 文件的表头为：

| 微信昵称 | 微信 Id | 好友昵称 | 好友 WechatId | 好友 Alias | 好友分组 | 消息内容 | 发送人 | 消息类型 | 发送状态 | 聊天时间 |
| -------- | ------- | -------- | ------------- | ---------- | -------- | -------- | ------ | -------- | -------- | -------- |
|          |         |          |               |            |          |          |        |          |          |          |

## 3. 输出 JSON 示例

```json
{
  "会话ID1": [
    {
      "客户": "您好"
    },
    {
      "客户": "祝您快乐"
    }
  ],
  "会话ID2": [
    {
      "客服": "您好"
    },
    {
      "客户": "hello"
    },
    {
      "客服": "稍等"
    },
    {
      "客服": "马上就到"
    }
  ]
}
```

## 4. TODO

* TS在这里处理excel数据不够方便，后续可以直接使用python重构，同时更符合LLM的信息处理

# python 连接使用 openai

## 1. 为什么LLM需要限制每次输入的token？

